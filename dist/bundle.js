(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,o,a,s=[],u=!0,l=!1;try{if(o=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;u=!1}else for(;!(u=(n=o.call(i)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){l=!0,r=t}finally{try{if(!u&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(l)throw r}}return s}}(t,e)||i(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function r(e,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,i){if("object"!==t(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===t(o)?o:String(o)),r)}var o}var o=function(){function t(e,i,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.individuals=[],this.individualCount=e,this.individualSize=i,this.mutationRate=n,this.averageFitness=0,this.generation=0,this.IndividualClass=r}var o,a;return o=t,(a=[{key:"spawn",value:function(){for(var t=0;t<this.individualCount;t++){var e=new this.IndividualClass(this.individualSize);e.random(),this.individuals[t]=e}return this.individuals}},{key:"pick",value:function(){for(var t=Math.random(),e=0;e<this.individualCount;e++)if(this.individuals[e].probability>t)return this.individuals[e]}},{key:"select",value:function(t){var e=[],i=this.individuals.reduce((function(t,e){return t+e.fitness}),0);this.individuals.forEach((function(t){t.probability=i/t.fitness}));var n=this.individuals.reduce((function(t,e){return t+e.probability}),0);this.individuals.forEach((function(t){t.probability/=n}));var r,o,a=0;this.individuals.forEach((function(t){a+=t.probability,t.probability=a}));for(var s=0;s<t;s++){for(o=r=this.pick();r===o;)o=this.pick();e.push([r,o])}return e}},{key:"crossover",value:function(){for(var t=[],i=this.select(Math.ceil(this.individualCount/2)),n=0;n<i.length;n++){var r=new this.IndividualClass(this.individualSize),o=new this.IndividualClass(this.individualSize),a=e(i[n],2),s=a[0],u=a[1],l=e(s.crossover(u),2);r.genes=l[0],o.genes=l[1],t.push(r,o)}return t}},{key:"generate",value:function(){var t;this.generation++,this.evaluate();var e,r=this.crossover();return(t=this.individuals).push.apply(t,function(t){if(Array.isArray(t))return n(t)}(e=r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),this.evaluate(),this.averageFitnesses.push(this.averageFitness),this.cull(),this.mutate(),this.individuals}}])&&r(o.prototype,a),Object.defineProperty(o,"prototype",{writable:!1}),t}();function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==a(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===a(r)?r:String(r)),n)}var r}function u(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?f(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==l(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===l(r)?r:String(r)),n)}var r}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}function v(t){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},v(t)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}(a,t);var e,i,n,r,o=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=v(n);if(r){var i=v(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),o.apply(this,arguments)}return e=a,(i=[{key:"random",value:function(){for(var t=[],e=0;e<this.size;e++)t.push(e);for(var i=0;i<this.size;i++)this.genes[i]=t.splice(Math.floor(Math.random()*t.length),1)[0]}},{key:"crossover",value:function(t){var e=[],i=[],n=Math.min(this.size-2,Math.max(Math.floor(Math.random()*this.size),1)),r=this.genes.slice(0,n);return e.push.apply(e,c(r)),e.push.apply(e,c(t.genes.filter((function(t){return!r.includes(t)})))),i.push.apply(i,c(t.genes.filter((function(t){return r.includes(t)})))),i.push.apply(i,c(this.genes.slice(n,this.size))),[e,i]}}])&&h(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),a}(u((function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.size=e,this.genes=[]})));function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function b(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==d(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===d(r)?r:String(r)),n)}var r}function m(t,e){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},m(t,e)}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m(t,e)}(a,t);var e,i,n,r,o=(n=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=g(n);if(r){var i=g(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,i){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,t,e.length,i,y)).cities=e,n.bestFitness=-1/0,n.previousBestFitness=-1/0,n.noImprovementCount=0,n.averageFitnesses=[],n}return e=a,(i=[{key:"getDistance",value:function(t,e){var i=this.cities[t],n=this.cities[e];return Math.hypot(n[0]-i[0],n[1]-i[1])}},{key:"evaluate",value:function(){this.averageFitness=0,this.previousBestFitness=this.bestFitness,this.bestFitness=-1/0;for(var t=0;t<this.individuals.length;t++){this.individuals[t].fitness=0;for(var e=0;e<this.individualSize-1;e++)this.individuals[t].fitness+=this.getDistance(this.individuals[t].genes[e],this.individuals[t].genes[e+1]);this.individuals[t].fitness+=this.getDistance(this.individuals[t].genes[0],this.individuals[t].genes[this.individualSize-1]),this.averageFitness+=this.individuals[t].fitness,this.individuals[t].fitness>this.bestFitness&&(this.bestFitness=this.individuals[t].fitness)}return this.averageFitness/=this.individuals.length,this.previousBestFitness>=this.bestFitness?this.noImprovementCount++:this.noImprovementCount=0,this.individuals}},{key:"cull",value:function(){this.individuals.sort((function(t,e){return e.fitness-t.fitness})),this.individuals.splice(0,this.individualCount)}},{key:"mutate",value:function(){for(var t=0;t<this.individualCount;t++)if(Math.random()<this.mutationRate){for(var e=[Math.floor(Math.random()*this.individualSize),Math.floor(Math.random()*this.individualSize)],i=e[0],n=e[1];i==n;)n=Math.floor(Math.random()*this.individualSize);var r=[this.individuals[t][n],this.individuals[t][i]];this.individuals[t][i]=r[0],this.individuals[t][n]=r[1]}return this.individuals}}])&&b(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),a}(o),C={evolveBtnId:"evolve-btn",resetCitiesBtnId:"reset-cities-btn",resetPopBtnId:"reset-pop-btn",cityInputId:"city-input",individualInputId:"individual-input",mutationRateInputId:"mutation-input",pathCanvasId:"path-canvas",fitnessCanvasId:"fit-canvas",shortestPathId:"shortest-path",generationCountId:"generation-count",cityFill:"rgba(255, 255, 255, 1)",popStrokeStyle:"rgba(125,180,255,0.01)",fittestStrokeStyle:"rgba(125, 180, 255, 1)",clearStyle:"rgba( 43,  45,  47, 1)",fitnessesStrokeColor:"rgba(255, 255, 255, 1)",fitnessesFillColor:"rgba(125, 180, 255, 0.01)",circleRadius:15};function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function P(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==w(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===w(r)?r:String(r)),n)}var r}function k(t,e,i){return e&&P(t.prototype,e),i&&P(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}var I=k((function t(e,i){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.callback=i,this.element=document.getElementById(this.id),this.element.onclick=function(t){return n.callback()}}));function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function O(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==j(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===j(r)?r:String(r)),n)}var r}var H=function(){function t(e,i,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.value=i,this.callback=n,this.element=document.getElementById(this.id),this.label=this.element.labels[0],this.element.value=this.value,this.element.oninput=function(t){var e=t.target;r.callback(parseFloat(e.value))}}var e,i;return e=t,(i=[{key:"updateLabel",value:function(t){this.label.textContent=t}}])&&O(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function M(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==T(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===T(r)?r:String(r)),n)}var r}var x=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.element=document.getElementById(e),this.context=this.element.getContext("2d"),this.width=this.element.width,this.height=this.element.height}var e,i;return e=t,i=[{key:"beginPath",value:function(){this.context.beginPath()}},{key:"moveTo",value:function(t,e){this.context.moveTo(t,e)}},{key:"clear",value:function(t){this.context.fillStyle=t,this.context.clearRect(0,0,this.width,this.height),this.context.fillRect(0,0,this.width,this.height)}},{key:"fill",value:function(t){this.context.fillStyle=t,this.context.fill()}},{key:"stroke",value:function(t,e){this.context.strokeStyle=t,this.context.lineWidth=e,this.context.stroke()}},{key:"traceCircle",value:function(t,e,i){this.context.moveTo(t+i,e),this.context.arc(t,e,i,0,2*Math.PI)}},{key:"traceLine",value:function(t,e,i,n){this.context.moveTo(t,e),this.context.lineTo(i,n)}},{key:"tracePolygon",value:function(t){this.context.moveTo(t[0][0],t[0][1]);for(var e=1;e<t.length;e++)this.context.lineTo(t[e][0],t[e][1]);this.context.lineTo(t[0][0],t[0][1])}},{key:"tracePath",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=0;i<t.length;i++)this.context.lineTo(t[i][0],t[i][1]);e&&this.context.closePath()}}],i&&M(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function F(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==E(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===E(r)?r:String(r)),n)}var r}var A=function(){function t(e,i,n,r,o,a,s,u,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=C,this.initCanvasHandlers(),this.initButtonHandlers(e,i,n),this.initInputHandlers(r,o,a,s,u,l),this.clearCanvases()}var e,i;return e=t,(i=[{key:"initInputHandlers",value:function(t,e,i,n,r,o){this.cityInputHandler=new H(this.config.cityInputId,e.toString(),t),this.updateCities(e),this.individualInputHandler=new H(this.config.individualInputId,n.toString(),i),this.updateIndividuals(n),this.mutationRateInputHandler=new H(this.config.mutationRateInputId,o.toString(),r),this.updateMutation(o),this.generationCountStat=document.getElementById(this.config.generationCountId),this.shortestPathStat=document.getElementById(this.config.shortestPathId)}},{key:"initCanvasHandlers",value:function(){this.pathCanvasHandler=new x(this.config.pathCanvasId),this.fitnessCanvasHandler=new x(this.config.fitnessCanvasId)}},{key:"initButtonHandlers",value:function(t,e,i){this.evolveBtnHandler=new I(this.config.evolveBtnId,t),this.resetCitiesBtnHandler=new I(this.config.resetCitiesBtnId,e),this.resetPopBtnHandler=new I(this.config.resetPopBtnId,i)}},{key:"clearCanvases",value:function(){this.pathCanvasHandler.clear(this.config.clearStyle),this.fitnessCanvasHandler.clear(this.config.clearStyle)}},{key:"clearStatistics",value:function(){this.fitnessCanvasHandler.clear(this.config.clearStyle),this.updateGeneration(0),this.updateShortest(0)}},{key:"displayCities",value:function(t){this.pathCanvasHandler.beginPath();for(var e=0;e<t.length;e++)this.pathCanvasHandler.traceCircle(t[e][0],t[e][1],this.config.circleRadius);this.pathCanvasHandler.fill(this.config.cityFill)}},{key:"displayGenes",value:function(t){this.pathCanvasHandler.beginPath();for(var e=0;e<t.length;e++)this.pathCanvasHandler.traceLine(t[e][0],t[e][1],t[e][2],t[e][3])}},{key:"displayPopulation",value:function(t){this.pathCanvasHandler.clear(this.config.clearStyle),this.displayGenes(t),this.pathCanvasHandler.stroke(this.config.popStrokeStyle,1)}},{key:"displayFittest",value:function(t){this.displayGenes(t),this.pathCanvasHandler.stroke(this.config.fittestStrokeStyle,1)}},{key:"displayAverageFitnesses",value:function(t){var e=this.fitnessCanvasHandler.width,i=this.fitnessCanvasHandler.height,n=e/t.length;this.fitnessCanvasHandler.beginPath(),this.fitnessCanvasHandler.moveTo(0,0);var r=t.map((function(t,e){return[Math.round(e*n),Math.round(i-i*t)]}));r.push([e,r[r.length-1][1]]),this.fitnessCanvasHandler.tracePath(r),this.fitnessCanvasHandler.stroke(this.config.fitnessesStrokeColor,3);var o=[[e,i],[0,i]];this.fitnessCanvasHandler.tracePath(o,!0),this.fitnessCanvasHandler.fill(this.config.fitnessesFillColor)}},{key:"sampleCanvas",value:function(t,e){var i,n;if(t==this.config.pathCanvasId)i=this.pathCanvasHandler.width,n=this.pathCanvasHandler.height;else{if(t!=this.config.fitnessCanvasId)return[-1,-1];i=this.fitnessCanvasHandler.width,n=this.fitnessCanvasHandler.height}return[Math.max(e,Math.min(i-e,Math.random()*i)),Math.max(e,Math.min(n-e,Math.random()*n))]}},{key:"updateCities",value:function(t){this.cityInputHandler.updateLabel("Cities: ".concat(t))}},{key:"updateIndividuals",value:function(t){this.individualInputHandler.updateLabel("Individuals: ".concat(t))}},{key:"updateMutation",value:function(t){this.mutationRateInputHandler.updateLabel("Mutation rate: ".concat(t))}},{key:"updateGeneration",value:function(t){this.generationCountStat.innerText=t.toString()}},{key:"updateShortest",value:function(t){this.shortestPathStat.innerText=t.toFixed(2)}}])&&F(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function B(t){return function(t){if(Array.isArray(t))return z(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return z(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?z(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function _(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==R(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===R(r)?r:String(r)),n)}var r}new(function(){function t(e,i,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cityCount=e,this.popSize=i,this.isPlaying=!1,this.mutationRate=n,this.gui=new A((function(){return r.run()}),(function(){return r.resetCities()}),(function(){return r.resetPopulation()}),(function(t){return r.updateCities(t)}),this.cityCount,(function(t){return r.updatePopulation(t)}),this.popSize,(function(t){return r.updateMutation(t)}),this.mutationRate),this.init()}var e,i;return e=t,i=[{key:"init",value:function(){this.createCities(),this.gui.displayCities(this.cities),this.createPopulation()}},{key:"createCities",value:function(){this.cities=[];for(var t=0;t<this.cityCount;t++)this.cities.push(this.gui.sampleCanvas(C.pathCanvasId,30))}},{key:"updateCities",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.cityCount;if(this.cities.length<t)for(var e=this.cities.length;e<t;e++)this.cities.push([Math.floor(Math.random()*this.gui.pathCanvasHandler.width),Math.floor(Math.random()*this.gui.pathCanvasHandler.height)]);else this.cities.splice(t);this.cityCount=t,this.population.cities=this.cities,this.gui.clearCanvases(),this.gui.clearStatistics(),this.gui.updateCities(this.cities.length),this.gui.displayCities(this.cities),this.createPopulation()}},{key:"resetCities",value:function(){this.createCities(),this.gui.updateCities(this.cities.length),this.gui.clearStatistics(),this.gui.clearCanvases(),this.gui.displayCities(this.cities),this.createPopulation()}},{key:"createPopulation",value:function(){this.population=new S(this.popSize,this.cities,this.mutationRate),this.population.spawn()}},{key:"updatePopulation",value:function(t){this.popSize=t,this.createPopulation(),this.gui.updateIndividuals(this.popSize),this.gui.clearStatistics()}},{key:"resetPopulation",value:function(){this.createPopulation(),this.gui.clearCanvases(),this.gui.displayCities(this.cities),this.gui.clearStatistics()}},{key:"individualToCityArray",value:function(t){for(var e=[],i=1;i<t.size;i++)e.push([].concat(B(this.cities[t.genes[i]]),B(this.cities[t.genes[i-1]])));return e.push([].concat(B(this.cities[t.genes[0]]),B(this.cities[t.genes[t.size-1]]))),e}},{key:"updateMutation",value:function(t){this.population.mutationRate=t,this.gui.updateMutation(t),this.gui.clearStatistics()}},{key:"getPopulationData",value:function(){for(var t=[],e=0;e<this.population.individualCount;e++){var i=this.population.individuals[e];t.push.apply(t,B(this.individualToCityArray(i)))}var n=this.population.individuals.sort((function(t,e){return e.fitness-t.fitness}))[0],r=this.individualToCityArray(n),o=n.fitness,a=B(this.population.averageFitnesses);return{genes:t,bestGenes:r,avgFitnesses:a,maxFitness:Math.max.apply(Math,B(a)),bestFitness:o}}},{key:"evolve",value:function(){if(0!=this.isPlaying){this.population.generate();for(var t=this.getPopulationData(),e=0;e<t.avgFitnesses.length;e++)t.avgFitnesses[e]/=t.maxFitness;this.gui.clearCanvases(),this.gui.displayAverageFitnesses(t.avgFitnesses),this.gui.displayPopulation(t.genes),this.gui.displayFittest(t.bestGenes),this.gui.displayCities(this.cities),this.gui.updateGeneration(this.population.generation),this.gui.updateShortest(t.bestFitness),this.population.noImprovementCount>=20&&this.isPlaying&&(clearInterval(this.rendererInterval),this.isPlaying=!1)}else clearInterval(this.rendererInterval)}},{key:"run",value:function(){var t=this;this.isPlaying=!0,this.population.noImprovementCount=0,this.rendererInterval=window.setInterval((function(e){return t.evolve()}),250)}}],i&&_(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}())(15,300,.1)})();